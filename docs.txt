Created the table for general report information:
CREATE TABLE reports (
    report_id           SERIAL PRIMARY KEY,
    org_name            TEXT,
    begin_ts            TIMESTAMPTZ,
    end_ts              TIMESTAMPTZ,
    external_report_id  TEXT
);

Example insertion:
INSERT INTO reports (
    org_name,
    begin_ts,
    end_ts,
    external_report_id
)
VALUES (
    'Enterprise Outlook',
    to_timestamp(1740614400),
    to_timestamp(1740614400),
    'b61eb9ac13af4d38918307982e4f16eb'
);

Created table for storing records from reports:
CREATE TABLE records (
    record_id   SERIAL PRIMARY KEY,
    report_id   INTEGER NOT NULL REFERENCES reports(report_id),
    source_ip   INET,
    msg_count   INTEGER,
    disposition TEXT,
    dkim_result TEXT,
    spf_result  TEXT,
    header_from TEXT
);

Example insert:
INSERT INTO records (
    report_id,
    source_ip,
    msg_count,
    disposition,
    dkim_result,
    spf_result,
    header_from
)
VALUES (
    1,
    '91.198.250.237',
    1,
    'none',
    'pass',
    'pass',
    'lolei.uk'
);

Used BeautifulSoup4 to parse xml files.

Added constraints to ensure unique records/reports easily:

ALTER TABLE reports
ADD CONSTRAINT unique_external_report_id
UNIQUE (external_report_id);

ALTER TABLE records
ADD CONSTRAINT unique_dmarc_record
UNIQUE (report_id, source_ip, disposition, dkim_result, spf_result);

Used SQLAlchemy to connect to and query the database.
Used pandas to print out reports and SQL query results.
